---
layout  : wiki
title   : Double Spending Problem
summary : 
date    : 2026-01-16 17:54:32 +0900
updated : 2026-01-16 18:15:24 +0900
tag     : blockchain bitcoin
toc     : true
comment : true
public  : true
parent  : [[/blockchain]]
latex   : true
---
* TOC
{:toc}

## Double Spending Problem

전산학 관점에서 ***[BLOCKCHAIN](https://klarciel.net/wiki/blockchain/)*** 은 "익명의 비동기화 네트워크에서 발생하는 사건들을 중앙 서버의 관여 없이도 일관성 있게 순서를 정할 수 있는 장치" 라고 했다.
그리고 이 순서를 정하는 것은 이중 사용(Double Spending) 문제와 직결된다.

이중 사용이란 하나의 비트코인을 여러 번 사용하려는 악의적인 행동이다. 예를 들어 직거래를 통해 가방을 0.002 BTC 에 구매한다고 가정하자. 
이때 구매자가 판매자에게 비트코인을 송금하고 판매자가 안심하고 바로 집에 갔다. 하지만 사토시는 ***[블록이 항상 평균 10여 분에 하나만 만들어지도록](https://klarciel.net/wiki/blockchain/blockchain-proof-of-work/)*** 하고 싶었다.
따라서, 송금 신청이란 구매자가 ***[BROADCASTING](https://klarciel.net/wiki/blockchain/blockchain-bitnode/)*** 을 토해 비트코인 시스템에 있는 전체 노드에게 자신이 판매자의 계좌로 0.002 BTC 를 지급한다는 의사를 트랜잭션으로 전달한 것에 불과하다.
만약, 구매자가 블록이 생성되기 전에 곧 바로 판매자에게 지급했던 것과 동일한 비트코인을 스스로에게 지급한다는 트랜잭션을 생성하게는 시나리오가 이중 사용 시나리오이다.

이러한 중앙 서버가 없는 비동기화 시스템에서 이중 사용 문제가 발생하는 이유는 시스템에 트랜잭션이 제출되는 순서와 트랜잭션이 처리되는 순서가 일치하지 않기 때문이다.
즉, 이중 지불(Double Spending) 문제의 근본 원인이 '잔고 부족'이 아니라 **'순서의 불일치'** 에 있다. 먼저 온 것을 유효로 치려면 "무엇이 먼저인가?"에 대한 합의가 필수적이다.
이는 분산 시스템의 난제인 **'전역 시계(Global Clock)의 부재'** 와 **'네트워크 지연(Network Latency)'** 의 문제이기도 하다. 예를 들면 A는 "철수가 영희에게 줬다"를 먼저 보고, B는 "철수가 민수에게 줬다"를 먼저 볼 수 있는 상황이다.

각 노드별로 전달 받은 트랜잭션과 순서는 서로 상이하다. 따라서 이러한 문제를 기술적으로 해결하기 위해서 ***네트워크 전체가 합의한 ‘거래의 순서’를 만드는 것*** 이 필요하다. 이 거래의 순서는
***리더 선출*** 을 통해서 리더만 가능하다. 즉, 어떤 거래가 먼저였는지, 어떤 거래가 나중이었는지를 모든 노드가 같은 방식으로 기억되게 하는 것이다. 이 순서를 위해서 ***Timestamp*** 를 사용한다.

분산 시스템(Distributed System)에서는 데이터의 일관성을 유지하기 위해 **"누가 기록할 권한(Write Authority)을 가질 것인가?"** 를 정해야 하며. 이 권한을 가진 노드를 **리더(Leader)** 라고 한다.
PoW 방식을 통해서 퍼즐(Nonce 찾기)을 가장 먼저 푼 채굴자가 "이번 10분 동안의 리더"가 된다. 만약 동시에 블록이 생성된 경우 동시에 생성된 것 중 가장 많은 연산을 한 블록을 만든 채굴자가 리더가 된다.

리더 선출은 PoW 는 단순한 계산 낭비가 아니라, **"누가 기록할 권한을 가질 것인가?"** 를 결정하는 공정한 리더 선출 방식(Lottery)이자 비용을 지불하게 하는 보안 장치이다.

또한 이중 사용 문제를 해결하기 위해서 ***[UTXO](https://klarciel.net/wiki/blockchain/blockchain-uxto/)*** 를 사용한다.

## References

- 비트코인의 탄생부터 블록체인의 미래까지 명쾌하게 이해하는 비트코인·블록체인 바이블 / 장세형 저
- 비트코인과 블렉체인 가상자산의 실체 2/e / 이병욱 저 